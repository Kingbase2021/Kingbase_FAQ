

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. 读写分离 &mdash; KingbaseES Frequently Asked Questions   documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/js/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. 高可用集群" href="cluster_faq.html" />
    <link rel="prev" title="12. Docker环境相关问题" href="docker.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> KingbaseES Frequently Asked Questions
          

          
          </a>

          
            
            
              <div class="version">
                 
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">前言</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="legalnotice.html">版权声明</a></li>
</ul>
<p class="caption"><span class="caption-text">常见问题</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sql.html">1. SQL类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id1">1.1. 空值问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sql.html#null">1.1.1. ‘’ 与 null 兼容性</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html#is-null">1.1.2. 判断值是否为空，要用 is null</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html#pg">1.1.3. PG模式下，‘’ 值问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html#ora-input-emptystr-isnull">1.1.4. Ora_input_emptystr_isnull对于字符类型空值的影响</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html#id2">1.1.5. Ora_input_emptystr_isnull对于数值类型空值的影响</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#core">1.2. Core分析</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sql.html#id3">1.2.1. 多线程core分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="sql.html#id4">1.2.2. 如何生成core文件</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id5">1.3. 关键字问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sql.html#id6">1.3.1. 如何确认是否系统关键字</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id7">1.4. 乱码或无效字符编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#windows">1.5. Windows版本安装未注册服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id8">1.6. 如何创建一个间隔分区</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#kesv8r2-3">1.7. [KESV8R2/3] 客服端服务器编码原理说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#mysqlsql-mode">1.8. 兼容MySQL参数sql_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#mysql-date-format">1.9. MySQL date_format改写</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id9">1.10. 共有同义词和私有同义词有什么区别</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id10">1.11. 同义词查找规则</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id11">1.12. 如何查询版本的提交号</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id12">1.13. 遇到关键字无法使用作为表名或列名</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#nextval">1.14. Nextval在同一条语句中的值</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id13">1.15. 能为模式指定表空间吗？</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id14">1.16. 丢失了数据库密码，如何恢复？</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#cache">1.17. 序列的cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#oid">1.18. 什么是OID？</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#ctid">1.19. 什么是CTID？</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id15">1.20. 数据库大小限制</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#kes">1.21. KES数据页结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#copy">1.22. 如何将数据从客户端通过copy命令导入数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id16">1.23. Windows 如何配置免密登录</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id17">1.24. 命令报参数错误问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#to-date">1.25. To_date 函数问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id18">1.26. 视图源定义信息为啥和创建的语句不一样</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id19">1.27. 字符串类型长度怎么获取</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#sys-guid">1.28. 如何改变sys_guid() 返回值类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#openssl">1.29. OPENSSL问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#pg-relation-size">1.30. Pg_relation_size 问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id20">1.31. 全角字符支持</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#id21">1.32. 时间函数问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#ddl">1.33. 如何取得对象的DDL信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#update">1.34. 全表update非常慢</a></li>
<li class="toctree-l2"><a class="reference internal" href="sql.html#failed-to-find-conversion-function-from-unknown-to-text">1.35. Failed to find conversion function from UNKNOWN to TEXT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plsql.html">2. PLSQL类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#kes-pl-sql-block-not-end-correctly">2.1. KES创建过程，报错：PL/SQL block not end correctly</a></li>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#out">2.2. 如何调用含out参数的存储过程</a></li>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#savepoint">2.3. Savepoint 使用问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#create-operator-bool">2.4. Create operator（bool与整型比较）</a></li>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#for">2.5. For循环变量</a></li>
<li class="toctree-l2"><a class="reference internal" href="plsql.html#id1">2.6. 函数变量不能超过512</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">3. 参数相关</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#kingbase-conf-kingbase-auto-conf">3.1. Kingbase.conf 与 kingbase.auto.conf 参数文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#id2">3.2. 不同参数如何生效</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#error-user-connect-times-and-max-error-user-connect-times">3.3. error_user_connect_times and max_error_user_connect_times</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#exclude-reserved-words">3.4. Exclude_reserved_words 排除关键字</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#max-locks-per-transaction">3.5. max_locks_per_transaction设置过大引发数据库启动问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#max-identifier-length">3.6. max_identifier_length</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html#id3">3.7. 数据库启动失败，报“内存段超过可用内存”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License 相关</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#id1">4.1. 如何查询license有效时间</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id2">4.2. 如何查询license完整信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id3">4.3. 如何查询license单项信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id4">4.4. 替换license步骤</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id5">4.5. 替换license是否要重启数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id6">4.6. 如何判断license有效</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#id7">4.7. License与网卡</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#bondlicense">4.8. Bond网卡切换license支持问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extended-plug-in.html">5. 扩展组件</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#id2">5.1. 如何查看系统是否支持某组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#oracle-fdw">5.2. oracle_fdw支持平台</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#create-extension-oracle-fdw-so">5.3. create extension oracle_fdw报.so找不到加载失败</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#id3">5.4. oracle_fdw支持功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#sys-pathman">5.5. Sys_pathman</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#separate-power">5.6. Separate_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="extended-plug-in.html#sysaudit">5.7. Sysaudit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="extended-plug-in.html#id4">5.7.1. 如何删除语句审计日志？</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gis.html">6. 空间组件</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gis.html#create-extension-postgris-glibc-2-18-not-defined-in-file-libc-so-6">6.1. Create extension postgris 报错“GLIBC_2.18 not defined in file libc.so.6”</a></li>
<li class="toctree-l2"><a class="reference internal" href="gis.html#acgis">6.2. acgis版本备份还原</a></li>
<li class="toctree-l2"><a class="reference internal" href="gis.html#r6">6.3. R6 是否支持超图</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="system-management.html">7. 系统管理类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="system-management.html#kesv8r2-r3">7.1. [KESV8R2/R3]表在指定表空间，为何显示为默认表空间？</a></li>
<li class="toctree-l2"><a class="reference internal" href="system-management.html#sys-class-reltablespace-0">7.2. 为什么sys_class里显示的很多表的 RELTABLESPACE值为 0？</a></li>
<li class="toctree-l2"><a class="reference internal" href="system-management.html#kes-sys-catalog">7.3. KES有什么办法，默认不读取sys_catalog下的系统视图？</a></li>
<li class="toctree-l2"><a class="reference internal" href="system-management.html#ip">7.4. 网线拔插后，IP丢失问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">8. 工具类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tools.html#s-pgsql-5432">8.1. 客户端连接找 .s.PGSQL.5432</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#er">8.2. 客户端管理工具无法加载ER图问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#client-encoding">8.3. 如何修改管理工具client_encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#id2">8.4. 迁移工具对于同名对象处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#invalid-byte-sequence-for-encoding-utf8-0x00">8.5. 数据迁移报“invalid byte sequence for encoding &quot;UTF8&quot;: 0x00 &quot;</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#id3">8.6. 开始菜单没有数据库快捷工具图标</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#gui">8.7. 缺少操作系统GUI组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#r3scram-sha-256">8.8. R3客户端无法使用scram-sha-256认证</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#undefined-symbol-pqgssencinuse">8.9. undefined symbol: PqgssEncInUse</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#bulkload">8.10. Bulkload并行加载报错</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-security.html">9. 数据安全</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-security.html#sys-rmancurrent-time-may-be-rewound">9.1. Sys_rman备份报“current time may be rewound”</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-security.html#id2">9.2. 如何导出一致时间点的数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-security.html#id3">9.3. 索引问题导致数据访问问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TPCC-test.html">10. TPCC测试类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TPCC-test.html#tpccautovacuum">10.1. tpcc测试中是否需要开启autovacuum</a></li>
<li class="toctree-l2"><a class="reference internal" href="TPCC-test.html#index-cursor-id">10.2. index_cursor_id参数的数值是固定的么？</a></li>
<li class="toctree-l2"><a class="reference internal" href="TPCC-test.html#tpccunixdomain">10.3. 在tpcc测试中unixdomain作用是？</a></li>
<li class="toctree-l2"><a class="reference internal" href="TPCC-test.html#id1">10.4. 集群环境下测试tpcc连接参数怎样配置？</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">11. 接口</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interface/jdbc.html">11.1. JDBC接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id1">11.1.1. JDBC打开日志方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#vip-jdbc">11.1.2. 没有VIP情况下，JDBC连接如何配置？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#v8r6-jdbcvip">11.1.3. V8R6 JDBC能否使用VIP？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#lobupdate">11.1.4. LOB对象update机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#kbblob-oracle">11.1.5. KBBlob 迁移至Oracle</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jdbcjarjdk-oscpu">11.1.6. JDBC的jar包需要区分JDK版本，需要区分OS和CPU平台吗？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jdbcurl">11.1.7. JDBC的连接参数只能通过URL串来填写吗？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id2">11.1.8. 如何使用JDBC配置文件方式？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id3">11.1.9. JDBC读写分离怎么打开关闭?</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id4">11.1.10. JDBC 读写分离都需要配置哪些参数？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id5">11.1.11. JDBC读写分离一主两备的URL和配置文件的样例</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id6">11.1.12. JDBC连接池功能，是否开启，开启后的功能及性能</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id7">11.1.13. JDBC读写分离配置参数依赖关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id8">11.1.14. JDBC读写分离在哪些情况下重发也不会成功</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id9">11.1.15. JDBC读写分离分发策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id10">11.1.16. JDBC读写分离相关参数默认值</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#sockettimeout0-jdbc">11.1.17. 集群状态正常，sockettimeout设置大于0时，为什么执行时间超长的事物会失败并导致jdbc重建连接？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#rewind">11.1.18. 主备切换后，备机rewind，或者备机故障后，备机恢复时为什么 备机的连接数是持续上升，而不是一次性全部建好？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#web-jdbc">11.1.19. 主机切机后，应用第一次登陆WEB慢，JDBC等待时间分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id11">11.1.20. JDBC打开日志方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jdbc-utf8">11.1.21. JDBC 报错：无效的 &quot;UTF8&quot; 编码字节顺序</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jvmjdbc">11.1.22. 系统JVM和应用和JDBC和数据库编码之间的关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#v7-v8-jdbc">11.1.23. V7 V8 JDBC 混用问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id20">11.1.24. JDBC读写分离模式混淆找不到表</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id21">11.1.25. JDBC读写分离日志分析办法</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jdbcssl">11.1.26. JDBC使用SSL加密</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id22">11.1.27. JDBC常见异常</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jdbcblob">11.1.28. JDBC读取BLOB乱码</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#id23">11.1.29. 读写分离分发现象分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#com-kingbase8-util-ksqlexception-error-type-q-does-not-exist-r6">11.1.30. com.kingbase8.util.KSQLException: ERROR: type &quot;q&quot; does not exist（R6）</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#fetchsize">11.1.31. fetchsize功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#r3r6-jar">11.1.32. 同时使用R3和R6，jar包冲突的解决方案</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc.html#jar">11.1.33. 如何查看jar包的版本号？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/spring-jdbc.html">11.2. Spring-JDBC 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/spring-jdbc.html#lobhandler">11.2.1. 大字段的设置--lobHandler</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/spring-jdbc.html#org-springframework-data-jdbc-repository-config-dialectresolver-nodialectexception-cannot-determine-a-dialect-for-org-springframework-jdbc-core-jdbctemplate-7c90b7b7-please-provide-a-dialect">11.2.2. org.springframework.data.jdbc.repository.config.DialectResolver$NoDialectException: Cannot determine a dialect for org.springframework.jdbc.core.JdbcTemplate&#64;7c90b7b7. Please provide a Dialect.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/hibernate.html">11.3. Hibernate使用常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#id1">11.3.1. Hibernate使用需要配置方言包</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#v8-hibernatelong">11.3.2. V8 Hibernate非法long值问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernate-1">11.3.3. Hibernate 无法确定参数类型$1</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernate-text-bytea">11.3.4. Hibernate 错误: 字段的类型为 TEXT, 但表达式的类型为 BYTEA你需要重写或转换表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernatesql">11.3.5. Hibernate控制输出真实SQL日志</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#springboot-jpa">11.3.6. Springboot JPA配置方言包问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernate-spatial">11.3.7. hibernate-spatial方言包配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernatenumericchar-1-javaboolean">11.3.8. hibernate使用numeric或char(1)映射java的boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#the-column-name-sequence-catalog-was-not-found-in-this-resultset">11.3.9. The column name sequence_catalog was not found in this ResultSet.</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hilo">11.3.10. 主键自增策略hilo</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#method-com-kingbase8-jdbc-kbpreparedstatement-setcharacterstream-int-reader-long-is-not-yet-implemented">11.3.11. Method com.kingbase8.jdbc.KbPreparedStatement.setCharacterStream(int, Reader, long) is not yet implemented.</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernatehql">11.3.12. Hibernate的hql不支持部分数据库函数的使用</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#hibernateupdate">11.3.13. Hibernate设置为update已经建好表，仍旧去建表</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#java-lang-nosuchmethoderror-javax-persistence-table-indexes-ljavax-persistence-index">11.3.14. java.lang.NoSuchMethodError: javax.persistence.Table.indexes()[Ljavax/persistence/Index;</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#user">11.3.15. 表取名user怎么规避？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/hibernate.html#id2">11.3.16. 其它模式下有同名表，导致当前模式没有表但未去建表</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/mybatis.html">11.4. Mybatis 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatissql">11.4.1. Mybatis设置SQL超时时间</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatislong">11.4.2. Mybatis非法long值问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatis-text-bytea">11.4.3. Mybatis 报错：字段的类型为 TEXT, 但表达式的类型为 BYTEA你需要重写或转换表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatis-jdbc">11.4.4. Mybatis 控制JDBC底层不走预编译</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatis-bind">11.4.5. Mybatis 控制Bind参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatis-pagehelper">11.4.6. Mybatis 使用pagehelper插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#id1">11.4.7. Mybatis 使用自动返回主键功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatisdatabaseid">11.4.8. Mybatis配置databaseId</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#id2">11.4.9. Mybatis使用匿名块插入语句报错</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatisscriptrunnerplsqlsql">11.4.10. Mybatis使用ScriptRunner执行含plsql的sql脚本报错</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#id3">11.4.11. Mybatis使用游标的注册方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis.html#mybatisjson">11.4.12. Mybatis写json类型示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/mybatis-plus.html">11.5. Mybatis-plus常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/mybatis-plus.html#id1">11.5.1. Mybatis-plus使用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/activiti.html">11.6. Activiti使用常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/activiti.html#id1">11.6.1. Activiti使用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/maven.html">11.7. Maven 仓库使用常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/maven.html#mavenkingbaseesjdbc">11.7.1. Maven本地仓库使用KingbaseES的JDBC驱动</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/maven.html#mavenkingbaseesdialect">11.7.2. Maven本地仓库使用KingbaseES的dialect方言包</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/druid.html">11.8. Druid 数据库连接池配置问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/druid.html#id1">11.8.1. Druid 配置国产金仓数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/druid.html#id2">11.8.2. Druid 配置例子</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/druid.html#id3">11.8.3. Druid的连接强制回收</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/c3p0.html">11.9. C3P0连接池配置问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/c3p0.html#c3p0v8">11.9.1. 常用C3p0配置金仓V8数据库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/DBCP.html">11.10. DBCP连接池配置问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/DBCP.html#dbcpv8">11.10.1. 常用dbcp配置金仓V8数据库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/apache-james.html">11.11. Apache James适配</a></li>
<li class="toctree-l2"><a class="reference internal" href="interface/pdo.html">11.12. Pdo接口常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#id1">11.12.1. 导入驱动失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#pdo-kdb">11.12.2. 加载 PDO_KDB 报错</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#php">11.12.3. PHP的线程安全和非线程安全</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#pdophp">11.12.4. 使用的PDO驱动与PHP版本不匹配</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#windowspdo">11.12.5. Windows下使用PDO驱动的方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#thinkphp">11.12.6. thinkphp使用过程中报函数不存在的问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/pdo.html#pdo-kdbpdo-pgsql">11.12.7. 通过金蝶等中间件查看驱动加载信息时，看不到pdo_kdb或者pdo_pgsql的信息</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/thinkPHP.html">11.13. ThinkPHP接口常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/thinkPHP.html#thinkphp-apache-kdb">11.13.1. 如何在搭建Thinkphp+apache+kdb环境</a><ul>
<li class="toctree-l4"><a class="reference internal" href="interface/thinkPHP.html#apache">11.13.1.1. apache环境搭建</a></li>
<li class="toctree-l4"><a class="reference internal" href="interface/thinkPHP.html#php">11.13.1.2. php环境搭建</a></li>
<li class="toctree-l4"><a class="reference internal" href="interface/thinkPHP.html#thinkphphttpd">11.13.1.3. thinkphp在httpd中使用</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/perl.html">11.14. Perl 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/perl.html#perl-pdi">11.14.1. Perl 驱动pdi无法加载问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/perl.html#perlperl">11.14.2. 怎么在perl中配置金仓perl驱动</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/perl.html#id3">11.14.3. 如何排查perl驱动加载失败步骤</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/odbc.html">11.15. ODBC常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#id1">11.15.1. 环境依赖</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#linux-unixodbc">11.15.2. linux unixodbc通过连接串连接数据库操作，如何添加连接参数？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#linuxodbc">11.15.3. linux环境下如何开启odbc驱动的日志？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#id2">11.15.4. linux下odbc驱动接口连接数据库失败，如何排查？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#id3">11.15.5. linux下odbc驱动开启日志？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#sqlfreestmt-sqlclosecursor">11.15.6. SQLFreeStmt()函数与SQLCloseCursor()有什么不同？</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/odbc.html#dns">11.15.7. 连接串中如何通过驱动名连接数据库，即不通过DNS连接数据库？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/C%23.html">11.16. C# 常见通过问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/C%23.html#ndp">11.16.1. NDP的连接数问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/C%23.html#ndpnet45net451-netcore2-0">11.16.2. NDP驱动net45、net451, netcore2.0有什么不同？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/python.html">11.17. Python通过PyODBC连接Kingbase的说明</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/python.html#id1">11.17.1. 环境配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/python.html#kingbasev7">11.17.2. KingbaseV7驱动配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/python.html#kingbasev8">11.17.3. KingbaseV8驱动配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/python.html#id2">11.17.4. 连接测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/ruby.html">11.18. Ruby 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/ruby.html#ruby-pgkingbasees-v8r3">11.18.1. 如何使用ruby-pg驱动连接至kingbaseES V8R3数据库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/qt.html">11.19. QT常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/qt.html#windowsqt">11.19.1. windows如何加载QT驱动</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/qt.html#id1">11.19.2. 提需求时，如何进行描述：</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/qt.html#ssl">11.19.3. SSL认证如何配置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/kci-v7.html">11.20. V7 KCI常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/kci-v7.html#kci-oidoid">11.20.1. 用KCI操作大对象写到用户的表里，发现OID不是创建的OID</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/oci-v7.html">11.21. V7 OCI常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/oci-v7.html#oci">11.21.1. OCI读写分离配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/oci-v7.html#id1">11.21.2. OCI日志分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/oci-v7.html#id2">11.21.3. OCI日志配置说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/oci-v7.html#id3">11.21.4. OCI配置文件如何配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/oci-v7.html#oci-dci">11.21.5. OCI 和DCI的头文件可以混用吗？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/jdbc-v7.html">11.22. V7 JDBC常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#jdbc">11.22.1. JDBC读写分离配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#id1">11.22.2. JDBC日志分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#id2">11.22.3. JDBC读写分离分发策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#fastpath-call-returned-invalid-large-object-descriptor-0">11.22.4. FastPath call returned invalid large object descriptor：0.</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#fetchsize">11.22.5. fetchsize功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/jdbc-v7.html#mybatis">11.22.6. mybatis一次执行多条语句时报错，错误信息为：“预置的语句中不能插入多个命令”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interface/SSL.html">11.23. SSL认证常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interface/SSL.html#id2">11.23.1. 证书生成</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/SSL.html#id3">11.23.2. 证书配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface/SSL.html#id4">11.23.3. 证书有效期</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">12. Docker环境相关问题</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#exit-code-137">12.1. 【exit code 137】错误信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html#docker-license">12.2. Docker 环境下license机制</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">13. 读写分离</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">13.1. 读写分离分发机制</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">13.2. 如何测试一下现场的备机失败，转发主机的场景？</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">13.3. 失败重发机制</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ssh">13.4. ssh 引发的相关问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">13.5. 读写分离备机备份报错</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hash">13.6. 读写分离集群Hash索引老是出问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cluster_faq.html">14. 高可用集群</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#libssl">14.1. libssl 问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#if-up-cmd-faild">14.2. if_up_cmd faild</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#arping">14.3. arping问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#arping-path">14.4. arping_path版本不正确</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#eshamodel-sh">14.5. esHAmodel.sh脚本错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#cluster">14.6. 集群名称不能使用cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#id2">14.7. 网络问题导致备机无法加入集群</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbasecluster">14.8. kingbasecluster服务启动失败</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#sys-md5">14.9. 集群sys_md5生成错误密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#node">14.10. 两节点读写分离集群，集群无法创建主备，两个node都是主</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#max-connections">14.11. 集群无法修改max_connections参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#id3">14.12. 软连接配置错误，导致集群启动报缺少磁盘空间</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#rootssh-auth-fail">14.13. 未配置root用户ssh互信，部署集群时，添加节点“auth fail”</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#show-pool-nodes">14.14. 防火墙导致集群show pool_nodes信息错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#v8r3auth-fail">14.15.  V8R3集群部署工具“auth fail”错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbase-monitor-shthere-are-no-1-standbys-in-sys-stat-replication">14.16. 集群通过kingbase_monitor.sh启动后“There are no 1 standbys in sys_stat_replication......&quot;</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kes-v8r2kingbasecluster9999">14.17. KES V8R2集群kingbasecluster服务9999端口无法连接</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#r3-sys-md5">14.18. R3集群部署工具部署时，出现sys_md5的错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#r3bmjeshamodel-sh">14.19. R3集群BMJ启动esHAmodel.sh失败问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#bmj-r3es-clientes-server">14.20. BMJ R3集群切换后es_client无法和es_server通讯问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbasees-r3standby">14.21. kingbaseES R3集群启动后“无standby”问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbasees-r3kingbasecluster">14.22. kingbaseES R3集群kingbasecluster无法正确识别备库状态</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbasees-r3-db-vip-cluster-vip">14.23. kingbaseES R3 集群无法加载db VIP 和cluster VIP案例</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#down">14.24. 网关无法连通，导致集群down，手工启动数据库服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbaseclusterkingbase-monitor-sh-kingbasecluster">14.25. 备库kingbasecluster服务通过kingbase_monitor.sh启动失败，手工启动kingbasecluster服务解决</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kes-v8r3kingbase-monitor-sh-pam-nologin-8">14.26. KES V8R3集群通过kingbase_monitor.sh启动失败，提示“pam_nologin(8)&quot;错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#conflict-with-recovery">14.27. conflict with recovery问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#sys-dump">14.28. sys_dump备份问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#sys-restore">14.29. sys_restore 恢复数据错误</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_faq.html#kingbasees-r6open-files">14.30. kingbaseES R6集群部署“open files”问题</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">KingbaseES Frequently Asked Questions</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">13. </span>读写分离</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1><span class="section-number">13. </span>读写分离<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2><span class="section-number">13.1. </span>读写分离分发机制<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>1、对于只读事务，如果事务内有多条SQL，会将每条SQL发至不同的节点（primary节点按比例，standby节点轮询）</p>
<p>2、对于读写混合事务，在第一个写操作之前，分发机制按读事务处理，包括写之后的所有SQL都在主节点执行</p>
<p>3、读写分离下，如果在备机报错ERROR或者FATAL的SQL，包括备机失败包括进程退出的错误，会把它自动再发送到主机重跑一遍。备机失败转发主机，主机如果也出现错误，并且是非IO错误，就会退出。</p>
</div>
<div class="section" id="id3">
<h2><span class="section-number">13.2. </span>如何测试一下现场的备机失败，转发主机的场景？<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>问题描述：</p>
<blockquote>
<div><p>如何测试一下现场的备机失败，转发主机的场景？</p>
</div></blockquote>
<p>解决方案：</p>
<blockquote>
<div><p>将HOSTLOADRATE设置成0，然后执行一个长查询，比如select sys_sleep(20)，然后杀掉备机。</p>
</div></blockquote>
</div>
<div class="section" id="id4">
<h2><span class="section-number">13.3. </span>失败重发机制<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>1、参数RETRYTIMES控制失败重试的次数，默认是10。</p>
<p>2、所有的重发都是重发主机</p>
<p>3、备机任意错误失败转发主机，主机失败是IO错误才会失败重发，socket超时是IO错误，但IO错误并不只有socket超时</p>
</div>
<div class="section" id="ssh">
<h2><span class="section-number">13.4. </span>ssh 引发的相关问题<a class="headerlink" href="#ssh" title="Permalink to this headline">¶</a></h2>
<p>1) 集群在启停时，需要ssh 到远程主机，修改crontab , 运行 sys_ctl 等。</p>
<p>2) 在启停集群时，如果主机间的免密认证有问题，会要求输入操作系统用户密码（通常是kingbase用户），只需重配主机间的信任关系。</p>
<p>3) sshd 服务只在集群启停时需要用到，暂时停止ssh服务不影响数据库使用。</p>
</div>
<div class="section" id="id5">
<h2><span class="section-number">13.5. </span>读写分离备机备份报错<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>适用版本：V8R3 , V8R6</p>
<p>问题描述：</p>
<blockquote>
<div><p>在备机执行Sys_dump时，报错“canceling statement due to conflict with recovery” “User was holding a relation lock for to long”</p>
</div></blockquote>
<p>问题分析：</p>
<blockquote>
<div><p>备机一直处于recovery模式，在恢复过程中，会中断与恢复冲突的相关操作。比如：同步主机的vacuum 操作，而备机上的Select操作可能需要访问“旧版本”记录，阻止了vacuum操作在备机上的执行。当备机上的查询时间过长是，备机的Recovery操作会终止查询操作（sys_dump本质也是个查询操作）。</p>
</div></blockquote>
</div>
<div class="section" id="hash">
<h2><span class="section-number">13.6. </span>读写分离集群Hash索引老是出问题<a class="headerlink" href="#hash" title="Permalink to this headline">¶</a></h2>
<p>适用版本：V8R3</p>
<p>问题描述：</p>
<blockquote>
<div><p>hash索引在备机不同步。对于异常宕机的情况，也需要重建hash索引。</p>
</div></blockquote>
<p>问题分析：</p>
<blockquote>
<div><p>由于R3版本hash 索引不记录wal日志，不能用于流复制。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>R6 版本已支持hash 索引记录wal日志</p>
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cluster_faq.html" class="btn btn-neutral float-right" title="14. 高可用集群" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docker.html" class="btn btn-neutral float-left" title="12. Docker环境相关问题" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 1999-2021, 北京人大金仓信息技术股份有限公司

    </p>
  </div>
    
    
     使用 <a href="http://sphinx-doc.org/">Sphinx</a> 创建 。
     最后更新于 Dec 14, 2021。 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>